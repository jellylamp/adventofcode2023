// @ts-ignore see https://github.com/jest-community/jest-extended#setup
import * as matchers from "jest-extended";
import {PipeMaze} from "./10-pipe-maze";
import {LightEmitter} from "./16-light-emitter";

expect.extend(matchers);

test("Day 16 puzzle a small simplified loop", () => {
  const input = `.|...\\....
|.-.\\.....
.....|-...
........|.
..........
.........\\
..../.\\\\..
.-.-/..|..
.|....-|.\\
..//.|....`;

  const lightEmitter = new LightEmitter(input, false);
  expect(lightEmitter.visited.size).toEqual(46);

  const lightEmitter2 = new LightEmitter(input, true);
  expect(lightEmitter2.highestCount).toEqual(51);
});

test("Day 16 puzzle input", () => {
  const input = `\\.-/...-\\......../.|......|.........../..-..................|....-.\\............................../...........
..........-.............\\...\\.........|..\\.......................-..........-.......\\.../.......-/............
........|.............-.....|..|........................\\.\\.../../.....-........................\\.............
....../\\.....................|........|.....-...........-..\\......./-.............................-........./.
.\\..\\.............-........|.......|...|..............................-..-......-......|......................
..........|/...\\.............\\............../-......\\.../........................./............./.../......../
..............\\......./..-...............|...........\\...|............|...........-..-............|...........
..........-...............|..././...........................................|...........-.../.-.|.....|.......
.........-...|..................-...........\\.-...................../.../........................|/......./...
.................................-.././...................|\\..............|.........../.......................
.............../......-.................\\....--.....-............................./.|./.................|.....
..../....|...|..................../....\\...|............|...../.././../--......\\.\\....|.......-............\\./
......\\....-...|......\\...........-......./..................../.....-..............\\.............|......./...
............|.\\...................|.........................|........\\............................./.\\.......|
............../...............................|.........../.................\\-.................../........../.
.|....|...........|..................|......./|\\\\.|\\.-...\\..../.........//........|............../...........|
........................|.....--......|.............-..................\\...../..../.......-....|...\\..........
...............\\........-........../...-|............\\......./.\\...........-|................/.-..............
..../....|.\\.............|......|...............................................|.................\\...........
.\\...\\......./.....|.\\....|..................-../|-......................|.................-..|......\\........
.../.........................................\\.....././....................|.......-........-......\\....|.....
.................\\./\\..-../......../...\\................................-......-..\\...........................
.......--..-........\\/........./........../...............\\..............\\...-........-......-../.........|...
.|...............-........./..............\\..\\......................|......./..|..............-.......|.|.....
........./............\\............|........\\...|...\\........-.......................|...................\\....
..................-\\......../.................\\.......\\.....|...........|..|-........\\.............|.......\\\\.
...|.........../.......|...../...|...\\........\\\\...................................-............-../...../....
......./....................|.........../...-................-....................\\.......|...................
\\....\\.......................-.|.\\...../..-...................|......................-..................../...
......|........-|...-/.|........................./.....|.....\\.........-........-......-.............././.....
......|.............-.\\...............................\\..|....\\..............|./..|./...\\......./..........|\\|
......././.\\...................-...-............/...................|/..........-\\./.................|........
.........|..........|\\../.........\\..............-.........\\................../\\./.............-..............
...\\.......................\\..................................\\...........................................|...
...|........\\..........|....|..../..|.........-\\.................-...-..\\.\\.........\\............|....|...//..
.././.....|.....-..........|.................\\.........\\........./......-...-.\\.\\.....................\\.......
......./....\\........\\\\..\\...|...../.................|.......|.\\.....\\............................../\\....\\...
.........\\......../.\\............|...............................................................|/...........
.\\.....-\\-.........|.........|....|...........-....\\.....|................\\...............-............./.....
.....-..............................-.....-..........-..................../..../........................|.....
...........\\...........-/....................-.....-............/........|........-/.........--./........-..\\\\
.|................................................|..................-.......|.............|\\/................
.|.................-.-..........|.........................../..../....../.....\\...../......./.................
........./..../..|..........\\..................\\....................................................../.......
.........\\............|.../......../........|......................../..../...|.\\...\\......................|..
........./................\\.............\\........|....................\\./......|.........-....../...../.......
..../.....|...../........-...................|............/.....||...............-....-.-.....................
\\./...\\.|...|.............|.......\\....../|...\\\\/.|.../....-.........\\\\|..|....-........\\............-.......|
......\\-..............|.....\\.....|...\\..............................|.....................\\......-.....|.....
......\\.-..........-..|......................................-..../......................../........\\.......|.
/...................-...\\.........--.............................\\...........\\................|......./.......
.................-......-..../..\\.............-./|......-....\\...........-...................\\.....|........-.
|........--.............\\...-....|.......|.\\............|...../\\...........\\/../............................-.
...|./-..\\.|...........\\........../..............................\\......-.......-.....|..........-........./..
.......-|..................-..........|..-............................../.............|..|.||.................
....-......................\\....\\..................\\......./............./..-........|..............-....|....
-..........-.........-.../|........--.............-................|..../|.................|..................
...\\......./..\\..\\......./|.....|-.............-............................\\..\\......\\...-..\\...............\\
./......................|..........\\...........|.|.......\\..........\\......................................\\..
................|...............-.../....\\......./.\\........-..............................|...-....-.........
..\\.......................\\..../..|.-.........-.............\\.......|../.|.|..|........|..............-.......
...........\\................\\..........................\\.....................\\........|.......................
..........|....\\.......\\...........|...../......................................./...\\.../........../.........
./...............\\...........|..-....-./..\\...\\...\\../...............-\\............\\....\\............-........
././............|................|........../...\\...../.............-....-.............\\......................
....-.|..................../.............................-...............................|....................
..-......|....-.........-...\\......\\.........||....-.\\............................-...|..............|........
........\\...........\\.-.......\\.../.........\\.../.....|.................../..|..|....\\..../..-................
..........-..................\\..|...|.|..\\......................./...........-......./.............|..\\...../.
.\\......|\\.|..\\.......|\\.-.......-........../........../..........\\.........../.........|.....................
./..........|..................//.|......|........-...\\...//............-.../..............|.......-....-.....
...............\\......\\........|.-................\\......-...................|.............-............-.-...
...........................\\/...........\\../..\\....................\\...........|.............-..........-.....
.............../........\\|.........\\..........-......../............-..........|........|/....................
....\\................-..................././........|.....|...........................-..|....................
\\-............-.......\\......\\.................../.......-.../............/....-..\\.......|................|..
.........................../....../.|...\\/...\\........-|.|.......\\..-........-............................../.
.................\\.....................|..........|.............|......|/.\\..........................-........
....\\../................................|.......-......|.................-......................|...-.../.....
....-.........|..../|..............................-|...............................-..-......\\.....-.........
./\\...............|.|..............-./..|........./...................................................\\.......
..............-....\\..|....../.....\\.............\\..............................-...-..../.....|..............
........-.........|..............................................-....\\--...........|\\...................../..
................/.|.................-....|......./............-...................../.-./\\................|...
................|............................../..-./.....|..-........................./.....|..............-.
....../........../.......|...|.....\\........./.............|..................................|.|.............
....................................................||.....|................/......-....../....../............
.........../.....\\...................|...........\\../....................................../.............../..
./.|............../.............................\\..|....\\-............./......................................
.........\\................../-.....|...........\\................|...../..................................|....
..|...../.....|...............\\.....-.................................|/............-..|..-...|......-........
....|....-..............|.......|............./\\-...........\\//.........|...........\\...../..............--...
.............-........\\|...........................-....../....||............/......./....................../.
|..................-......\\.........-.......|..............................\\.|/..................\\......\\.-...
....../.......................|........|..|.\\...........|.........\\................\\\\..................\\.../..
...........-....|...........||...-.......|.|....-.....\\\\-................|.........../..................\\/....
................|.-.................|-./..-..|.........-..............-.........-../........................-.
.....................-.....................................|.........\\......||./................|.............
............/...-............|......./......................................../..........................-....
..../.......\\.-............|..........|....-...........\\.-.................................\\./...|............
...........|.-........|.|....-...........\\......-...-..........|.\\.|.|.....\\....\\............../..............
......\\...\\....../....\\......\\.|......................./.......................\\.................../..../\\....
...../.|...............|.../\\.........................................-...........|./........................|
.........................-.-.......\\./..........|.........|/.......-......................-...-..|\\|........\\.
..................|......-..................|..........\\..-../........................-......\\...\\............
..|...............\\.............../.........-./............../.../..../.|\\......\\..../-.....|....-.........|..
...-..-..............--...|...................................................|.-.../.../.....\\.....\\.........
.\\./.../..............././.........\\.........|..\\..........\\.................\\..|.....-......-................
......-...................|../....................|...............|.............|/..\\.......|........\\......|.
......\\/.....|................./..................................|.......|./........|.............-...-......`;

  const lightEmitter = new LightEmitter(input, false);
  expect(lightEmitter.visited.size).toEqual(7979);

  const lightEmitter2 = new LightEmitter(input, true);
  expect(lightEmitter2.highestCount).toEqual(8437);
});
